<?xml version="1.0" encoding="utf-8"?>
<openerp>
  <data>

    <record id="view_picking_out_new_state_form" model="ir.ui.view">
        <field name="name">stock.picking.out.new.state.form</field>
        <field name="model">stock.picking.out</field>
        <field name="inherit_id" ref="stock.view_picking_out_form"></field>
        <field name="arch" type="xml">
          <xpath expr="//form/header/button[@name='button_cancel']"
                 position="before">
              <button name="action_delivered" states="done"  type="object"
                      string="Delivered" groups="base.group_user"/>
          </xpath>
          <xpath expr="//form/header/field[@name='state']" position="attributes">
              <attribute name="statusbar_visible">draft,assigned,done,delivered</attribute>
          </xpath>
        </field>
    </record>

    <!--Add filter for new state Delivered-->
    <record id="view_picking_out_search_delivered" model="ir.ui.view">
      <field name="name">stock.picking.out.search.delivered</field>
      <field name="inherit_id" ref="stock.view_picking_out_search" />
      <field name="model">stock.picking.out</field>
      <field name="arch" type="xml">
        <data>
          <filter string="To Invoice" position="after">
            <filter icon="terp-dolar_ok!"
                    string="Delivered"
                    domain="[('state','=', 'delivered')]"/>
          </filter>
        </data>
      </field>
    </record>

  </data>
</openerp>
